machine:
  python:
    version: "3.6.3"

dependencies:
  pre:
    - pip install tox pytest pytest-cov fakeredis networkx mypy
    - pip install -r scripts/linting/requirements.txt
    - sudo apt-get update ; sudo apt-get install python3 python3-setuptools
  override:
    - rm -rf routemaster.egg-info
    - pip install -e .

test:
  pre:
    - find . -name '__pycache__' -or -name '*.pyc' | xargs rm -rf
  override:
    - tox
    - mv build/pytest/ $CIRCLE_TEST_REPORTS/pytest
