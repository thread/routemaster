# Logging Plugins

Logging plugins are Routemaster's mechanism for exposing logs and metrics
about its performance and behaviour.

Plugins are all inactive by default, and must be enabled in your Routemaster
configuration file like so:

```yaml
plugins:
  logging:
    - class: routemaster.logging:PythonLogger
      kwargs:
        log_level: DEBUG
```

## Available logging plugins

### Python Logger

Routemaster comes with the above `PythonLogger` that uses Python's logging
system, and can be configured with a log level. It outputs basic information
to stdout.


### Sentry Logger

Maintained in the Routemaster repo is a Sentry plugin. This can be configured
with a Sentry "dsn", and will report exceptions to Sentry.

```yaml
plugins:
  logging:
    - class: routemaster_sentry.logger:SentryLogger
      kwargs:
        dsn: https://xxxxxxx:xxxxxxx@sentry.io/xxxxxxx
```


### Prometheus Logger

The Prometheus logger is also maintained in the Routemaster repo. It provides
a Prometheus compatible scrape target for metrics at the path `/metrics`, on
the same port as the API.

Several metrics about the behaviour and performance of Routemaster are
exposed, including timings and status codes of the API, webhook requests and
feed requests, as well as the processing of jobs in the internal cron system.


```yaml
plugins:
  logging:
    - class: routemaster_prometheus.logger:PrometheusLogger
```


## Implementing a logging plugin

A logging plugin must inherit from `routemaster.logging.BaseLogger`, and can
override any of the methods on it.

It should be noted that some of the core methods are context managers, and
wrap a piece of functionality in Routemaster. If overridden, these methods
_must_ yield to perform their behaviour, and are also required to not swallow
any exceptions except those generated within the method itself. This is to
ensure that other plugins will see exceptions generated by Routemaster and
will get a chance to act on them.
