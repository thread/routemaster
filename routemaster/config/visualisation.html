<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<style>
#cy {
  height: 100%;
  width: 100%;
  position: absolute;
  left: 0;
  top: 0;
}
</style>
<title>Visualisation of state machine {{ state_machine_name }}</title>
</head>
<body>
  <script type="text/javascript">
    var state_machine_config = {{ state_machine_config|tojson }};
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/cytoscape/3.2.11/cytoscape.js"></script>
  <div id="cy"></div>
  <script>
    var cy = cytoscape({
      container: document.querySelector('#cy'),

      boxSelectionEnabled: false,
      autounselectify: true,

      style: cytoscape.stylesheet()
        .selector('node')
          .css({
            'content': 'data(id)',
            'text-valign': 'center',
            'color': 'black',
          })
          .style({
            'shape': 'square',
            'width': 'label',
            'height': 'label',
            'padding': '1em',
          })
        .selector('edge')
          .css({
            'curve-style': 'bezier',
            'target-arrow-shape': 'triangle',
            'target-arrow-color': '#ccc',
            'line-color': '#ccc',
            'width': 1
          })
        .selector(':selected')
          .css({
            'background-color': 'black',
            'line-color': 'black',
            'target-arrow-color': 'black',
            'source-arrow-color': 'black'
          })
        .selector('.action')
          .css({
            'background-color': 'orange',
          })
        .selector('.gate')
          .css({
            'background-color': 'lightBlue',
          }),

      elements: state_machine_config,

      layout: {
        name: 'breadthfirst',
        fit: true, // whether to fit the viewport to the graph
        directed: true, // whether the tree is directed downwards (or edges can point in any direction if false)
        padding: 30, // padding on fit
        spacingFactor: 0.55, // positive spacing factor, larger => more space between nodes (N.B. n/a if causes overlap)
        avoidOverlap: true, // prevents node overlap, may overflow boundingBox if not enough space
        nodeDimensionsIncludeLabels: false, // Excludes the label when calculating node bounding boxes for the layout algorithm
      }
    });
  </script>
</body>
</html>
